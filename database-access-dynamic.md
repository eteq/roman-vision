# Database Access Science Case (Stretch Goal): "Write a dynamic query that the user specifies in galactic coordinates that then auto-translates to what the catalog sees"

Daenerys is early-career faculty who has built a reputation as a forward-thinking leader. She is known for breaking the chains of old workflows that her collaborators have and setting them free to do their science using tools she develops or helps them use. As a result, she has some datasets from a variety of different groups and conventions. For this science case, she's especially interested in doing an analysis of Milky Way stars in the High Latitude Wide Area Survey, to trace certain theory-predicted signals of high temperature ISM features that are known as "Dragons".  To do this, she needs to cross-match The whole HLWAS with other multi-wavelength datasets.

To do this, she turns to a soft-money researcher working for her: Jorah.  Jorah was exiled from his home institution for financial irregularities, but has been reformed by Daenerys' inspirational leadership.  He has access to a heterogeneous but large (hundreds of millions of rows) catalog with multiwavelength data of the sort Daenerys needs to do her Roman Project.  The catch is: all of its coordinates are expressed in a particular variety of Galactic Coordinates that is non-standard, and the matching tolerances are tight enough that it has to be carefully converted to other coordinate systems.

Daenerys is undeterred, though, and uses her willingness to think in new ways: she remembers hearing about Roman's use of the HIPSCat project to do cross-matching, and starts looking for interface information.  She finds the documentation of the HIPSCat machinery, and sees that the Roman HLWAS is accessible through that interface.  She also figures out that HIPSCat has an experimental interface to allow dynamic catalog-matching.  This allows her to use the Astropy coordinate transformations, which are all implemented in Python, and runnable in the regular kernel on the Roman Science Platform, to do transformations as part of the query to the HIPSCat catalogs. Daenerys tasks Jorah with working out the coordinate transformation code while she hatches an analysis approach that should reveal the Dragons in the data.  Jorah eventually manages to express the transformation as a custom Astropy coordinate transformation, which can be implemented directly in a notebook on the platform.  This transformation is then fed into HIPSCat, yielding a lazy set of matches that Daenerys can use to grab the matches in a particular HIPSCat skycell.

Starting from a random cell, Daenerys plots up just that small subset of the data, carefully training her Dragon code.  It seems to fight with her at times, and in the end she needs three different Dragon fields to be able to pin down her approach to detecting them.  But in the end she is quite confident that the system she devised with Jorah's help is working.  They then set a long-running job to do the analysis on the full dataset, and it executes in a reasonable time only because the HIPSCat machinery can optimize these queries.

In the end they have an extremely strong signal that was only possible by sifting through all these Roman HLWAS data and matching them to the multi-wavelength dataset.  Daenerys goes to a conference at a place called Vaes Dothrak.  There, surrounded by a number of powerful leaders of her field, she presents her results.  They prepare to completely destroy her with questions, but she burns them all away in a conflagration of overpowering data.  The audience all bow, and begin whispering to each other that Daenerys truly is "Mother of Dragons."


## Notes 

* While it might seem like an easier solution for this case is "just add a Galactic Coordinates column to the database", the point of this science case is that scientists may have their own coordinate systems or transformations of database queries that are easily expressed in code but not easily expressed in a standard coordiate form. That is true regardless of the details of the science case, and this science case is about enabling that flexibility, not the specific case of Galactic Coordinates.
* The HIPSCat transform could be expressed as a concept notebook if that would be helpful. NO?
* All the actual code for the transform is in custom user software, not in the server itself. That is, it is not in-scope to actually *write* custom transforms, but rather to have the capbility for custom transforms to be provided by the user and then evaluated as part of the search.
* This use case depends on some work being done in HIPSCat which either we can do or we can hope that HIPSCat will do it.  In that sense this is something of a stretch goal.
* The long-running job aspect needs more development on the RSP side, so exact definitions are being left vague. Considerations needed include: 1) resource limits, 2) pausing jobs, 3) checkpointing in case something fails.